{% if messages %}
<div id="alerta" class="alert alert-warning align-items-center" role="alert" data-auto-redirect="true">
  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi flex-shrink-0 me-2 bi-exclamation-triangle-fill" role="img" aria-label="Warning:" viewBox="0 0 16 16">
  <path d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5m.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2"/>
  </svg>
  <div>
    {% for message in messages %}
      {% if forloop.first %}
        <p>{{ message }}</p>
      {% endif %}
    {% endfor %}
  </div>
</div>
<script>
setTimeout(() => {
    let alert = document.getElementById('alerta');
    if (alert && alert.dataset.autoRedirect === 'true'){
        // Fade out suave
        alert.style.transition = 'opacity 0.5s';
        alert.style.opacity = '0';
        
        setTimeout(() => {
            alert.remove(); 
            
            // REDIRECIONA APÃ“S SUMIR
            {% if user.is_authenticated %}
                {% if user.patients.exists %}
                    window.location.href = "{% url 'home_user' id=user.id month=1 year=1 %}";
                {% elif user.professionals.exists %}
                    window.location.href = "{% url 'home_specialist' id=user.id %}";
                {% endif %}
            {% endif %}
        }, 500); // 0.5s do fade out
    }
}, 5000) // 5s inicial
</script>

{% endif %}
